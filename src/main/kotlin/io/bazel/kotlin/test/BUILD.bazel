load("//kotlin:jvm.bzl", "kt_jvm_binary")
load(":bash.bzl", "bash_path")

bash_path(name = "bash_path")

kt_jvm_binary(
    name = "BazelIntegrationTestRunner",
    srcs = [
        "BazelIntegrationTestRunner.kt",
    ],
    data = [
        ":bash_path",
        "//:rules_kotlin_release",
    ],
    jvm_flags = [
        "-D@rules_kotlin...rules_kotlin_release=$(rlocationpath //:rules_kotlin_release)",
        "-Dio.bazel.kotlin.test.bash_path=$(rlocationpath :bash_path)",
    ],
    main_class = "io.bazel.kotlin.test.BazelIntegrationTestRunner",
    visibility = [
        "//visibility:public",
    ],
    deps = [
        "//src/main/kotlin/io/bazel/kotlin/builder/utils",
        "@kotlin_rules_maven//:org_apache_commons_commons_compress",
    ],
)
